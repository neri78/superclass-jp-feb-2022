(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{480:function(e,r,t){"use strict";t.r(r);var s=t(56),o=Object(s.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"twilio-proxyの利用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#twilio-proxyの利用"}},[e._v("#")]),e._v(" Twilio Proxyの利用")]),e._v(" "),t("p",[e._v("このセクションでは"),t("a",{attrs:{href:"https://www.twilio.com/ja/proxy",target:"_blank",rel:"noopener noreferrer"}},[e._v("Twilio Proxy"),t("OutboundLink")],1),e._v("を用いた匿名通話を実装します。")]),e._v(" "),t("p",[e._v("事前に音声通話が可能なTwilio番号を保有していることを確認してください。")]),e._v(" "),t("p",[t("strong",[e._v("目次")])]),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#コンソールでproxyサービスを作成"}},[e._v("コンソールでProxyサービスを作成")])]),t("li",[t("a",{attrs:{href:"#サービス-service-の作成"}},[e._v("サービス（Service）の作成")])]),t("li",[t("a",{attrs:{href:"#電話番号の追加"}},[e._v("電話番号の追加")])]),t("li",[t("a",{attrs:{href:"#セッションの作成"}},[e._v("セッションの作成")])]),t("li",[t("a",{attrs:{href:"#参加者-participant-の追加"}},[e._v("参加者（Participant）の追加")])])])]),t("p"),e._v(" "),t("h2",{attrs:{id:"コンソールでproxyサービスを作成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#コンソールでproxyサービスを作成"}},[e._v("#")]),e._v(" コンソールでProxyサービスを作成")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://console.twilio.com",target:"_blank",rel:"noopener noreferrer"}},[e._v("Twilioコンソール"),t("OutboundLink")],1),e._v("においてサイドナビゲーションに表示されている"),t("a",{attrs:{href:"https://console.twilio.com/develop/explore",target:"_blank",rel:"noopener noreferrer"}},[e._v("Explore Products"),t("OutboundLink")],1),e._v("を開きます。ここでは"),t("code",[e._v("Programmable communication")]),e._v(" - "),t("code",[e._v("Proxy")]),e._v("を選択します。")]),e._v(" "),t("p",[e._v("もし見つからない場合は下記のリンクから直接開いてください。")]),e._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://www.twilio.com/console/proxy",target:"_blank",rel:"noopener noreferrer"}},[e._v("Proxyコンソール"),t("OutboundLink")],1)])]),e._v(" "),t("h2",{attrs:{id:"サービス-service-の作成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#サービス-service-の作成"}},[e._v("#")]),e._v(" サービス（Service）の作成")]),e._v(" "),t("p",[e._v("Twilio Proxyを利用するため、新しい"),t("code",[e._v("Service")]),e._v("を作成します。"),t("code",[e._v("Services")]),e._v("画面において"),t("code",[e._v("Create Service")]),e._v("ボタンをクリックし新しいサービスを作成します。")]),e._v(" "),t("p",[e._v("サービス名の入力を求められるため、任意の名前を設定します。")]),e._v(" "),t("p",[e._v("作成されたサービスの設定（Configure）画面が表示されます。今回は初期状態のまま利用しますが、"),t("code",[e._v("Service")]),e._v("の"),t("code",[e._v("SID")]),e._v("を控えておきます。")]),e._v(" "),t("h2",{attrs:{id:"電話番号の追加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#電話番号の追加"}},[e._v("#")]),e._v(" 電話番号の追加")]),e._v(" "),t("p",[e._v("Proxyサービスには匿名通話のための共通番号をあらかじめ設定しておく必要があります。")]),e._v(" "),t("p",[e._v("先ほど表示したサービスの設定画面を開くと左側にナビゲーションが表示されます。"),t("code",[e._v("Numbers")]),e._v("を選択し、"),t("code",[e._v("Add Numbers")]),e._v("ボタンをクリックします。スクリーンショットを参考にしてください。")]),e._v(" "),t("p",[e._v("現在保有している番号の一覧からTwilio Proxyサービスで利用する番号を1つ以上選択し、"),t("code",[e._v("Assign")]),e._v("ボタンをクリックします。")]),e._v(" "),t("p",[e._v("この追加した番号にそれぞれが電話をかけることで匿名通話が成立します。")]),e._v(" "),t("h2",{attrs:{id:"セッションの作成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#セッションの作成"}},[e._v("#")]),e._v(" セッションの作成")]),e._v(" "),t("p",[e._v("Twilio Proxy では通話を"),t("code",[e._v("Session")]),e._v("という単位で管理します。この"),t("code",[e._v("Session")]),e._v("では通話者をマッピングします。")]),e._v(" "),t("p",[e._v("セッションはコンソールであらかじめ作成する方法とアプリケーションから動的に作成する方法があります。\nこのハンズオンではコンソールからこのセッションを作成し、動作を確認します。")]),e._v(" "),t("p",[e._v("先ほど同様に作成したProxyの設定画面をコンソールで開き、左側のナビゲーションから"),t("code",[e._v("Sessions")]),e._v("を選択します。")]),e._v(" "),t("p",[t("code",[e._v("Create new Session")]),e._v("をクリックし表示されたポップアップ内でセッションの名前を設定します。また、"),t("code",[e._v("MODE")]),e._v("は"),t("code",[e._v("Voice Only")]),e._v("とします。")]),e._v(" "),t("p",[e._v("作成された"),t("code",[e._v("Session")]),e._v("の"),t("code",[e._v("SID")]),e._v("を控えておきます。")]),e._v(" "),t("h2",{attrs:{id:"参加者-participant-の追加"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参加者-participant-の追加"}},[e._v("#")]),e._v(" 参加者（Participant）の追加")]),e._v(" "),t("p",[e._v("セッションには参加者（Participant）を追加する必要があります。この作業はコンソールから実施できないため、Twilio Functionsのハンズオンでも使用したTwilio CLIを用いて参加者を追加します。")]),e._v(" "),t("p",[e._v("Twilio CLIを用いて参加者をセッションに追加する場合は次のコマンドを実行します。")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("twilio api:proxy:v1:services:sessions:participants:create \\\n    --service-sid <Service SIDの値> \\\n    --session-sid <Session SIDの値> \\\n    --identifier <E.164電話番号>\n")])])]),t("p",[e._v("標準の設定ではセッションに参加者を追加する場合、"),t("code",[e._v("identifier")]),e._v("に指定する番号とProxyサービスに登録されているTwilio番号のCountryコードがマッチしなければいけません。指定した番号に対応するTwilio番号が存在しない場合は、下記のエラーが発生します。")]),e._v(" "),t("div",{staticClass:"custom-block danger"},[t("p",{staticClass:"custom-block-title"},[e._v("エラーメッセージ")]),e._v(" "),t("p",[e._v("» Error code 80203 from Twilio: This Service has no compatible Proxy numbers for this Participant. This Service has no available Proxy numbers for country code JP. See https://www.twilio.com/docs/errors/80203 for more info.")])]),e._v(" "),t("p",[e._v("この場合は該当する国のTwilio番号を購入し、割り当てるか、"),t("code",[e._v("--proxy-identifier")]),e._v("オプションを指定し、あらかじめ参加者に対して該当セッションで利用するProxy番号を割り当てることになります。")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("twilio api:proxy:v1:services:sessions:participants:create "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --service-sid "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Service SIDの値"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --session-sid "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Session SIDの値"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --identifier "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("E.164電話番号"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    --proxy-identifier "),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("Proxyサービスに設定されている番号"),t("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),t("p",[e._v("それぞれの値を置き替えて2名の参加者を追加してください。1人目としてご自身の番号を、2人目についてはハンズオン時に指定された番号を利用してください。")]),e._v(" "),t("p",[e._v("どちらかの番号からProxy番号に発信し、相手に番号を通知することなく、匿名通話が可能であることを確認します。")])])}),[],!1,null,null,null);r.default=o.exports}}]);